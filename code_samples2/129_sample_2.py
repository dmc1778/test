        # for time-distributed data, collapse time and sample
        y = np.reshape(y, (-1, yshape[-1]))